(function(){class Bizon{#defaultOptions={title:null,images:[],callbacks:{onClose:null}};#options={};#bizonEl=null;#mainImageWrapper=null;#mainImageEl=null;#mainVideoEl=null;#rightButtonEl=null;#leftButtonEl=null;#closeButtonEl=null;#currentImageIndex=0;#bizonHtml=[`<div id="bizon-slider" class="prevent-select">`,`<div id="bizon-main-image"></div>`,`<div id="bizon-thumbnails"></div>`,`</div>`].join("");constructor(options){this.#options={...this.#defaultOptions,...options}}show(){if(this.#options.images.length===0){console.warn("Bizon: images are not provided");return}else if(this.#options.images.length>1&&this.#options.images.some(imgObj=>this.#isVideo(imgObj))){console.error("Bizon gallery does not support gallery for video files");return}this.#initBizonEl();this.#initMainImage();this.#initThumbnails();this.#initControls();this.#setMainImage(this.#currentImageIndex);this.#bindEvents()}#isVideo(imageObj){return typeof imageObj.type=="string"&&imageObj.type.toLowerCase()=="video"||imageObj.src.match(/\.(mp4|wmv|mpg|mpeg)$/g)}hide(){this.#unbindEvents();this.#bizonEl.remove();if(typeof this.#options.callbacks.onClose=="function"){this.#options.callbacks.onClose()}}#initBizonEl(){if(this.#bizonEl){this.#bizonEl.remove();this.#bizonEl=null}const bizonWrapper=document.createElement("div");bizonWrapper.innerHTML=this.#bizonHtml;this.#bizonEl=bizonWrapper.firstChild;this.#bizonEl.parentNode.removeChild(this.#bizonEl);bizonWrapper.remove();if(this.#options.images.length<=1){this.#bizonEl.classList.add("bizon-single-image")}document.body.appendChild(this.#bizonEl)}#initMainImage(){this.#mainImageWrapper=document.createElement("div");this.#mainImageWrapper.id="bizon-main-image-wrapper";this.#mainImageEl=document.createElement("img");this.#bizonEl.querySelector("#bizon-main-image").appendChild(this.#mainImageWrapper)}#initThumbnails(){if(this.#options.images.length<=1){return}const that=this;this.#options.images.forEach((img,idx)=>{const tagName=typeof img.type=="string"&&img.type.toLowerCase()=="video"?"video":"img";let imgEl=document.createElement(tagName);imgEl.src=img.thumb||img.src;if(img.caption){imgEl.setAttribute("alt",img.caption);imgEl.setAttribute("title",img.caption)}let wrapperEl=document.createElement("div");wrapperEl.classList.add("bizon-thumb-wrapper");wrapperEl.setAttribute("thumb-index",idx);if(idx==0){wrapperEl.classList.add("bizon-thumb-wrapper-active")}wrapperEl.appendChild(imgEl);wrapperEl.onclick=e=>{this.#setMainImage(idx)};that.#bizonEl.querySelector("#bizon-thumbnails").appendChild(wrapperEl)})}#setMainImageEl(){const currentImageObj=this.#options.images[this.#currentImageIndex];const isVideo=typeof currentImageObj.type=="string"&&currentImageObj.type.toLowerCase()=="video"||currentImageObj.src.match(/\.(mp4|wmv|mpg|mpeg)$/g);if(this.#mainImageWrapper.firstChild){this.#mainImageWrapper.removeChild(this.#mainImageWrapper.firstChild)}let mainEl;if(isVideo){this.#mainVideoEl=document.createElement("video");this.#mainVideoEl.autoplay=true;this.#mainVideoEl.playsinline=true;this.#mainVideoEl.muted=false;this.#mainVideoEl.loop=true;this.#mainVideoEl.controls=true;this.#mainVideoEl.controlsList="nodownload";this.#mainVideoEl.oncontextmenu="return false;";mainEl=this.#mainVideoEl}else{this.#mainVideoEl=document.createElement("img");mainEl=this.#mainImageEl}mainEl.setAttribute("alt",currentImageObj.caption||"");mainEl.setAttribute("title",currentImageObj.caption||"");mainEl.src=currentImageObj.src;setTimeout(()=>{const wrapperWidth=this.#mainImageWrapper.clientWidth;const wrapperHeight=this.#mainImageWrapper.clientHeight;const wrapperRatio=1*wrapperWidth/wrapperHeight;const mediaRatio=1*currentImageObj.width/currentImageObj.height;if(wrapperRatio>mediaRatio){mainEl.style.height=wrapperHeight+"px";mainEl.style.width="auto"}else{mainEl.style.width=wrapperWidth+"px";mainEl.style.height="auto"}});this.#mainImageWrapper.appendChild(mainEl)}#setMainImage(idx){if(idx>=this.#options.images.length||idx<0){return}this.#currentImageIndex=idx;this.#setMainImageEl();this.#setActiveThumbnail();this.#updateControlsVisibility()}#setActiveThumbnail(){if(this.#options.images.length<=1){return}const idx=this.#currentImageIndex;[].forEach.call(this.#bizonEl.querySelectorAll(".bizon-thumb-wrapper-active"),el=>{el.classList.remove("bizon-thumb-wrapper-active")});const thumbs=this.#bizonEl.querySelector("#bizon-thumbnails").childNodes;thumbs[idx].classList.add("bizon-thumb-wrapper-active")}#initControls(){const mainImageSection=this.#bizonEl.querySelector("#bizon-main-image");const moveLeftSection=document.createElement("div");moveLeftSection.classList.add("bizon-move-section");moveLeftSection.classList.add("bizon-move-section-left");const moveRightSection=document.createElement("div");moveRightSection.classList.add("bizon-move-section");moveRightSection.classList.add("bizon-move-section-right");this.#leftButtonEl=document.createElement("div");this.#leftButtonEl.classList.add("bizon-move-arrow");this.#leftButtonEl.classList.add("bizon-move-arrow-left");this.#leftButtonEl.title="Previous";this.#rightButtonEl=document.createElement("div");this.#rightButtonEl.classList.add("bizon-move-arrow");this.#rightButtonEl.classList.add("bizon-move-arrow-right");this.#rightButtonEl.title="Next";this.#closeButtonEl=document.createElement("div");this.#closeButtonEl.classList.add("bizon-close-button");this.#closeButtonEl.title="Close";moveLeftSection.appendChild(this.#leftButtonEl);moveRightSection.appendChild(this.#rightButtonEl);moveRightSection.appendChild(this.#closeButtonEl);mainImageSection.appendChild(moveLeftSection);mainImageSection.appendChild(moveRightSection)}#updateControlsVisibility(){this.#bizonEl.querySelector(".bizon-move-arrow-right").style.display=this.#currentImageIndex>=this.#options.images.length-1||this.#options.images.length<=1?"none":"initial";this.#bizonEl.querySelector(".bizon-move-section-left").style.visibility=this.#currentImageIndex<=0?"hidden":"visible"}#bindEvents(){this.#rightButtonEl.parentNode.onclick=e=>{if(e.target==this.#closeButtonEl){this.hide();return}this.#setMainImage(this.#currentImageIndex+1)};this.#leftButtonEl.parentNode.onclick=e=>{this.#setMainImage(this.#currentImageIndex-1)};this.#bizonEl.querySelector("#bizon-main-image-wrapper").onclick=e=>{if(e.target==this.#bizonEl.querySelector("#bizon-main-image-wrapper")){this.hide()}};window.__bizon_keydown_callback=e=>{if(e.key==="Escape"){this.hide()}if(e.key==="ArrowRight"){this.#setMainImage(this.#currentImageIndex+1)}if(e.key==="ArrowLeft"){this.#setMainImage(this.#currentImageIndex-1)}};window.addEventListener("keydown",window.__bizon_keydown_callback,false)}#unbindEvents(){window.removeEventListener("keydown",window.__bizon_keydown_callback)}}window.Bizon=Bizon})();